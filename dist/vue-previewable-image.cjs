"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const r=require("vue"),I=require("viewerjs"),b=(n,e=!0,l,o)=>{const u=r.ref(),v=r.ref(""),d=r.ref(!1),w=r.ref(!1),a=r.ref(!1),i=r.ref(!1),c=r.ref(),p=()=>{c.value=new IntersectionObserver(s=>{s.forEach(m=>{const{intersectionRatio:_,target:g}=m;if(_>0&&!g.classList.contains("lazy-loaded")){const t=new Image;i.value=!0,t.addEventListener("load",f=>{g.classList.add("lazy-loaded"),v.value=n,a.value=!0,d.value=!0,w.value=!1,i.value=!1,o&&o(f)}),t.addEventListener("error",f=>{g.classList.add("lazy-loaded"),a.value=!0,w.value=!0,d.value=!1,i.value=!1,l&&l(f)}),t.src=n}})},{threshold:[1]}),u.value&&c.value.observe(u.value)};return r.onMounted(()=>{e?p():v.value=n}),r.onUnmounted(()=>{var s;u.value&&((s=c.value)==null||s.unobserve(u.value))}),{lazySrc:v,lazyloadSuccess:d,lazyloadError:w,lazyloaded:a,lazyloading:i,lazyloadTrigger:u}};function P(n){return typeof n[0]=="string"}const x=r.defineComponent({model:{prop:"modelValue",event:"update:modelValue"},props:{modelValue:{type:Boolean,default:!1},currentPreviewIndex:{type:Number,default:0},previewSrcList:{type:Array,default:()=>[]},viewerOptions:{type:Object,default:()=>({})},viewerTitle:{type:Function,default:void 0},zIndex:{type:[Number,String],default:2015}},emits:["update:modelValue","update:currentPreviewIndex","switch"],setup(n,{emit:e}){const{modelValue:l,previewSrcList:o,currentPreviewIndex:u}=r.toRefs(n),v=r.computed(()=>o.value&&o.value.length>0),d=r.ref(),w=()=>{var t;(t=d.value)==null||t.view(i.value)};r.watch(l,t=>{t&&w()});const a=r.computed(()=>v.value?P(o.value)?o.value.map(t=>({src:t,alt:t})):o.value:[]),i=r.computed({get(){return u.value},set(t){e("update:currentPreviewIndex",t)}}),c=r.computed(()=>o.value.length||0),p=()=>{const t=document.createElement("div");return a.value.forEach(f=>{const y=new Image;Object.keys(f).forEach(V=>{y[V]=f[V]}),t.appendChild(y)}),t.addEventListener("view",f=>{const y=f;i.value=y.detail.index,e("switch",i.value,d.value)}),t.addEventListener("hidden",f=>{console.log(f),e("update:modelValue",!1)}),t},s=r.computed(()=>n.viewerTitle?t=>n.viewerTitle(t,{index:i.value,total:c.value}):t=>`${t.alt} (${i.value+1}/${c.value})`),m=r.computed(()=>Object.assign({title:s.value,zIndex:n.zIndex},n.viewerOptions)),_=()=>{v.value&&(d.value=new I(p(),m.value),l.value&&w())},g=()=>{_()};return r.onMounted(()=>{g()}),r.onUnmounted(()=>{var t;(t=d.value)==null||t.destroy()}),{hasPreviewList:v,PreviewListLength:c,finalPreviewSrcList:a,viewer:d,handleImgView:w}}});function z(n,e,l,o,u,v,d,w){var a=typeof n=="function"?n.options:n;e&&(a.render=e,a.staticRenderFns=l,a._compiled=!0),o&&(a.functional=!0),v&&(a._scopeId="data-v-"+v);var i;if(d?(i=function(s){s=s||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!s&&typeof __VUE_SSR_CONTEXT__!="undefined"&&(s=__VUE_SSR_CONTEXT__),u&&u.call(this,s),s&&s._registeredComponents&&s._registeredComponents.add(d)},a._ssrRegister=i):u&&(i=w?function(){u.call(this,(a.functional?this.parent:this).$root.$options.shadowRoot)}:u),i)if(a.functional){a._injectStyles=i;var c=a.render;a.render=function(m,_){return i.call(_),c(m,_)}}else{var p=a.beforeCreate;a.beforeCreate=p?[].concat(p,i):[i]}return{exports:n,options:a}}var L=function(){var e=this,l=e._self._c;return e._self._setupProxy,l("div",{staticClass:"image-viewer"})},O=[],C=z(x,L,O,!1,null,"ea9ad1dd",null,null);const S=C.exports;const E=r.defineComponent({name:"PreviewableImage",components:{ImageViewer:S},props:{width:{type:String,default:void 0},height:{type:String,default:void 0},src:{type:String,default:""},alt:{type:String,default:""},referrerPolicy:{type:String,default:void 0},fit:{type:String,default:"fill"},zIndex:{type:[Number,String],default:2015},previewSrcList:{type:Array,default:()=>[]},currentPreviewIndex:{type:Number,default:0},viewerOptions:{type:Object,default:()=>({})},viewerTitle:{type:Function,default:void 0},lazy:{type:Boolean,default:!0}},emits:["switch","update:currentPreviewIndex","load","error"],setup(n,{emit:e}){const{previewSrcList:l,currentPreviewIndex:o}=r.toRefs(n),u=r.computed(()=>({"--img-object-fit":n.fit})),{lazySrc:v,lazyloadTrigger:d,lazyloading:w,lazyloadError:a,lazyloadSuccess:i}=b(n.src,n.lazy,t=>{e("load",t)},t=>{e("error",t)}),c=r.computed(()=>l.value&&l.value.length>0),p=r.computed(()=>!(!c.value||n.lazy&&!i.value)),s=r.ref(!1),m=()=>{c.value&&(s.value=!0)},_=r.computed({get(){return o.value},set(t){e("update:currentPreviewIndex",t)}});return{lazyloadTrigger:d,imgStyleVars:u,hasPreviewList:c,lazySrc:v,lazyloading:w,lazyloadError:a,lazyloadSuccess:i,showImageViewer:s,handleImgView:m,currentViewerIndex:_,handleSwitch:(t,f)=>{e("switch",t,f)},initViewer:p}}});var T=function(){var e=this,l=e._self._c;return e._self._setupProxy,l("div",{ref:"lazyloadTrigger",staticClass:"previewable-image",style:[{width:e.width,height:e.height},e.imgStyleVars]},[e.lazy&&e.lazyloading?l("div",{staticClass:"previewable-image__placeholder"},[e._t("placeholder",function(){return[e._v("Loading...")]})],2):e.lazy&&e.lazyloadError?l("div",{staticClass:"previewable-image__error"},[e._t("error",function(){return[e._v("Load Error")]})],2):l("img",{class:["previewable-image__inner",{"previewable-image__preview":e.hasPreviewList}],attrs:{src:e.lazySrc,alt:e.alt,referrerpolicy:e.referrerPolicy},on:{click:e.handleImgView}}),e.initViewer?l("ImageViewer",{attrs:{"current-preview-index":e.currentViewerIndex,"preview-src-list":e.previewSrcList,"viewer-options":e.viewerOptions,"viewer-title":e.viewerTitle,"z-index":e.zIndex},on:{"update:currentPreviewIndex":function(o){e.currentViewerIndex=o},"update:current-preview-index":function(o){e.currentViewerIndex=o},switch:e.handleSwitch},model:{value:e.showImageViewer,callback:function(o){e.showImageViewer=o},expression:"showImageViewer"}}):e._e()],1)},$=[],R=z(E,T,$,!1,null,null,null,null);const h=R.exports,N=(n,e)=>{const l=Object.assign({componentName:h.name,defaultViewerOptions:{}},e);n.component(l.componentName,h),I.setDefaults(l.defaultViewerOptions)},F={install:N};exports.Viewer=I;exports.ImageViewer=S;exports.PreviewableImage=h;exports.default=F;
