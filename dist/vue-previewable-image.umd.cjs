(function(u,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("viewerjs")):typeof define=="function"&&define.amd?define(["exports","vue","viewerjs"],t):(u=typeof globalThis<"u"?globalThis:u||self,t(u.VuePreviewableImage={},u.Vue,u.Viewer))})(this,function(u,t,S){"use strict";const L=(a,e=!0,l,w)=>{const s=t.ref(),c=t.ref(""),f=t.ref(!1),_=t.ref(!1),n=t.ref(!1),i=t.ref(!1),g=t.ref(),v=()=>{g.value=new IntersectionObserver(o=>{o.forEach(d=>{const{intersectionRatio:y,target:p}=d;if(y>0&&!p.classList.contains("lazy-loaded")){const m=new Image;i.value=!0,m.addEventListener("load",h=>{p.classList.add("lazy-loaded"),c.value=a,n.value=!0,f.value=!0,_.value=!1,i.value=!1,w&&w(h)}),m.addEventListener("error",h=>{p.classList.add("lazy-loaded"),n.value=!0,_.value=!0,f.value=!1,i.value=!1,l&&l(h)}),m.src=a}})},{threshold:[1]}),s.value&&g.value.observe(s.value)};return t.onMounted(()=>{e?v():c.value=a}),t.onUnmounted(()=>{var o;s.value&&((o=g.value)==null||o.unobserve(s.value))}),{lazySrc:c,lazyloadSuccess:f,lazyloadError:_,lazyloaded:n,lazyloading:i,lazyloadTrigger:s}},F="";function T(a){return typeof a[0]=="string"}const C=t.defineComponent({name:"PreviewableImage",props:{width:{type:String,default:void 0},height:{type:String,default:void 0},src:{type:String,default:""},alt:{type:String,default:""},referrerPolicy:{type:String,default:void 0},fit:{type:String,default:"fill"},zIndex:{type:[Number,String],default:2015},previewSrcList:{type:Array,default:()=>[]},currentPreviewIndex:{type:Number,default:0},viewerOptions:{type:Object,default:()=>({})},viewerTitle:{type:Function,default:void 0},lazy:{type:Boolean,default:!0}},emits:["switch","update:currentPreviewIndex","load","error"],setup(a,{emit:e}){const{previewSrcList:l,currentPreviewIndex:w}=t.toRefs(a),{lazySrc:s,lazyloadTrigger:c,lazyloading:f,lazyloadError:_,lazyloadSuccess:n}=L(a.src,a.lazy,r=>{e("load",r)},r=>{e("error",r)}),i=t.ref(),g=t.computed(()=>({"--img-object-fit":a.fit})),v=t.computed(()=>l.value&&l.value.length>0),o=t.computed(()=>v.value?T(l.value)?l.value.map(r=>({src:r,alt:r})):l.value:[]),d=t.computed({get(){return w.value},set(r){e("update:currentPreviewIndex",r)}}),y=t.computed(()=>l.value.length||0),p=()=>{const r=document.createElement("div");return o.value.forEach(z=>{const b=new Image;Object.keys(z).forEach(P=>{b[P]=z[P]}),r.appendChild(b)}),r.addEventListener("view",z=>{const b=z;d.value=b.detail.index,e("switch",d.value,i.value)}),r},m=t.computed(()=>a.viewerTitle?r=>a.viewerTitle(r,{index:d.value,total:y.value}):r=>`${r.alt} (${d.value+1}/${y.value})`),h=t.computed(()=>Object.assign({title:m.value,zIndex:a.zIndex},a.viewerOptions)),I=()=>{v.value&&(a.lazy&&!n.value||(i.value=new S(p(),h.value)))};t.watch([n,l],()=>{I()},{deep:!0});const j=()=>{var r;(r=i.value)==null||r.view(d.value)},x=()=>{I()};return t.onMounted(()=>{x()}),t.onUnmounted(()=>{var r;(r=i.value)==null||r.destroy()}),{lazyloadTrigger:c,PreviewListLength:y,finalPreviewSrcList:o,imgStyleVars:g,viewer:i,handleImgView:j,hasPreviewList:v,lazySrc:s,lazyloading:f,lazyloadError:_}}}),N="";function E(a,e,l,w,s,c,f,_){var n=typeof a=="function"?a.options:a;e&&(n.render=e,n.staticRenderFns=l,n._compiled=!0),w&&(n.functional=!0),c&&(n._scopeId="data-v-"+c);var i;if(f?(i=function(o){o=o||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!o&&typeof __VUE_SSR_CONTEXT__<"u"&&(o=__VUE_SSR_CONTEXT__),s&&s.call(this,o),o&&o._registeredComponents&&o._registeredComponents.add(f)},n._ssrRegister=i):s&&(i=_?function(){s.call(this,(n.functional?this.parent:this).$root.$options.shadowRoot)}:s),i)if(n.functional){n._injectStyles=i;var g=n.render;n.render=function(d,y){return i.call(y),g(d,y)}}else{var v=n.beforeCreate;n.beforeCreate=v?[].concat(v,i):[i]}return{exports:a,options:n}}var V=function(){var e=this,l=e._self._c;return e._self._setupProxy,l("div",{ref:"lazyloadTrigger",staticClass:"previewable-image",style:[{width:e.width,height:e.height},e.imgStyleVars]},[e.lazy&&e.lazyloading?l("div",{staticClass:"previewable-image__placeholder"},[e._t("placeholder",function(){return[e._v("Loading...")]})],2):e.lazy&&e.lazyloadError?l("div",{staticClass:"previewable-image__error"},[e._t("error",function(){return[e._v("Load Error")]})],2):l("img",{class:["previewable-image__inner",{"previewable-image__preview":e.hasPreviewList}],attrs:{src:e.lazySrc,alt:e.alt,referrerpolicy:e.referrerPolicy},on:{click:e.handleImgView}})])},O=[],$=E(C,V,O,!1,null,null,null,null);const R=$.exports;u.Viewer=S,u.PreviewableImage=R,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})});
