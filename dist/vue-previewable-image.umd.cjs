(function(u,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue"),require("viewerjs")):typeof define=="function"&&define.amd?define(["exports","vue","viewerjs"],t):(u=typeof globalThis<"u"?globalThis:u||self,t(u.VuePreviewableImage={},u.Vue,u.Viewer))})(this,function(u,t,S){"use strict";const O=(r,e=!0,i,w)=>{const s=t.ref(),c=t.ref(""),f=t.ref(!1),p=t.ref(!1),n=t.ref(!1),l=t.ref(!1),g=t.ref(),v=()=>{g.value=new IntersectionObserver(o=>{o.forEach(d=>{const{intersectionRatio:_,target:y}=d;if(_>0&&!y.classList.contains("lazy-loaded")){const m=new Image;l.value=!0,m.addEventListener("load",h=>{y.classList.add("lazy-loaded"),c.value=r,n.value=!0,f.value=!0,p.value=!1,l.value=!1,w&&w(h)}),m.addEventListener("error",h=>{y.classList.add("lazy-loaded"),n.value=!0,p.value=!0,f.value=!1,l.value=!1,i&&i(h)}),m.src=r}})},{threshold:[1]}),s.value&&g.value.observe(s.value)};return t.onMounted(()=>{e?v():c.value=r}),t.onUnmounted(()=>{var o;s.value&&((o=g.value)==null||o.unobserve(s.value))}),{lazySrc:c,lazyloadSuccess:f,lazyloadError:p,lazyloaded:n,lazyloading:l,lazyloadTrigger:s}},F="";function T(r){return typeof r[0]=="string"}const V=t.defineComponent({name:"PreviewableImage",props:{width:{type:String,default:void 0},height:{type:String,default:void 0},src:{type:String,default:""},alt:{type:String,default:""},referrerPolicy:{type:String,default:void 0},fit:{type:String,default:"fill"},zIndex:{type:[Number,String],default:2015},previewSrcList:{type:Array,default:()=>[]},currentPreviewIndex:{type:Number,default:0},viewerOptions:{type:Object,default:()=>({})},viewerTitle:{type:Function,default:void 0},lazy:{type:Boolean,default:!0}},emits:["switch","update:currentPreviewIndex","load","error"],setup(r,{emit:e}){const{previewSrcList:i,currentPreviewIndex:w}=t.toRefs(r),{lazySrc:s,lazyloadTrigger:c,lazyloading:f,lazyloadError:p,lazyloadSuccess:n}=O(r.src,r.lazy,a=>{e("load",a)},a=>{e("error",a)}),l=t.ref(),g=t.computed(()=>({"--img-object-fit":r.fit})),v=t.computed(()=>i.value&&i.value.length>0),o=t.computed(()=>v.value?T(i.value)?i.value.map(a=>({src:a,alt:a})):i.value:[]),d=t.computed({get(){return w.value},set(a){e("update:currentPreviewIndex",a)}}),_=t.computed(()=>i.value.length||0),y=()=>{const a=document.createElement("div");return o.value.forEach(z=>{const b=new Image;Object.keys(z).forEach(L=>{b[L]=z[L]}),a.appendChild(b)}),a.addEventListener("view",z=>{const b=z;d.value=b.detail.index,e("switch",d.value,l.value)}),a},m=t.computed(()=>r.viewerTitle?a=>r.viewerTitle(a,{index:d.value,total:_.value}):a=>`${a.alt} (${d.value+1}/${_.value})`),h=t.computed(()=>Object.assign({title:m.value,zIndex:r.zIndex},r.viewerOptions)),P=()=>{v.value&&(r.lazy&&!n.value||(l.value=new S(y(),h.value)))};t.watch([n,i],()=>{P()},{deep:!0});const N=()=>{var a;(a=l.value)==null||a.view(d.value)},x=()=>{P()};return t.onMounted(()=>{x()}),t.onUnmounted(()=>{var a;(a=l.value)==null||a.destroy()}),{lazyloadTrigger:c,PreviewListLength:_,finalPreviewSrcList:o,imgStyleVars:g,viewer:l,handleImgView:N,hasPreviewList:v,lazySrc:s,lazyloading:f,lazyloadError:p}}}),M="";function C(r,e,i,w,s,c,f,p){var n=typeof r=="function"?r.options:r;e&&(n.render=e,n.staticRenderFns=i,n._compiled=!0),w&&(n.functional=!0),c&&(n._scopeId="data-v-"+c);var l;if(f?(l=function(o){o=o||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!o&&typeof __VUE_SSR_CONTEXT__<"u"&&(o=__VUE_SSR_CONTEXT__),s&&s.call(this,o),o&&o._registeredComponents&&o._registeredComponents.add(f)},n._ssrRegister=l):s&&(l=p?function(){s.call(this,(n.functional?this.parent:this).$root.$options.shadowRoot)}:s),l)if(n.functional){n._injectStyles=l;var g=n.render;n.render=function(d,_){return l.call(_),g(d,_)}}else{var v=n.beforeCreate;n.beforeCreate=v?[].concat(v,l):[l]}return{exports:r,options:n}}var E=function(){var e=this,i=e._self._c;return e._self._setupProxy,i("div",{ref:"lazyloadTrigger",staticClass:"previewable-image",style:[{width:e.width,height:e.height},e.imgStyleVars]},[e.lazy&&e.lazyloading?i("div",{staticClass:"previewable-image__placeholder"},[e._t("placeholder",function(){return[e._v("Loading...")]})],2):e.lazy&&e.lazyloadError?i("div",{staticClass:"previewable-image__error"},[e._t("error",function(){return[e._v("Load Error")]})],2):i("img",{class:["previewable-image__inner",{"previewable-image__preview":e.hasPreviewList}],attrs:{src:e.lazySrc,alt:e.alt,referrerpolicy:e.referrerPolicy},on:{click:e.handleImgView}})])},$=[],R=C(V,E,$,!1,null,null,null,null);const I=R.exports,j={install:(r,e)=>{const i=Object.assign({componentName:I.name,defaultViewerOptions:{}},e);r.component(i.componentName,I),S.setDefaults(i.defaultViewerOptions)}};u.Viewer=S,u.PreviewableImage=I,u.default=j,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
